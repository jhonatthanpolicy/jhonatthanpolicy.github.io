{
  "$schema": "https://vega.github.io/schema/vega-lite/v6.json",
  "title": {
    "text": "Japan Population",
    "anchor": "start",
    "subtitle": "Total | Source: JSB (WB) through ECO API",
    "fontSize": 14,
    "subtitleFontSize": 12,
    "color": "#000000",
    "subtitleColor": "#000000"
  },

  "width": 520,
  "height": 250,
  "padding": { "left": 50, "right": 10, "top": 10, "bottom": 80 },

  "background": "#ffffff",
  "view": { "strokeOpacity": 0 },

  "data": {
    "url": "https://api.economicsobservatory.com/jpn/popu?vega",
    "format": { "type": "json" }
  },

  "transform": [
    { "filter": "year(datum.date) >= 1980 && year(datum.date) <= 2023" }
  ],

  "layer": [
    {
      "mark": {
        "type": "line",
        "color": "#f4134d",
        "strokeWidth": 2
      },
      "encoding": {
        "x": {
          "field": "date",
          "type": "temporal",
          "scale": {
            "domain": [
              "1980-01-01",
              "2023-12-31"
            ]
          },
          "axis": {
            "title": "",
            "grid": false,
            "tickCount": { "interval": "year", "step": 1 },
            "format": "%Y",
            "labelAngle": -90,
            "labelFontSize": 9,
            "labelPadding": 4,
            "labelOverlap": false
          }
        },
        "y": {
          "field": "value",
          "type": "quantitative",
          "axis": {
            "title": "",
            "grid": false,
            "labelFontSize": 11
          },
          "scale": {
            "domainMin": 100000000
          }
        }
      }
    },

    {
      "transform": [
        { "filter": "year(datum.date) == 2022" }
      ],
      "mark": {
        "type": "rule",
        "color": "black",
        "strokeDash": [6, 6],
        "size": 1.5
      },
      "encoding": {
        "y": {
          "field": "value",
          "type": "quantitative"
        }
      }
    },

    {
      "transform": [
        { "filter": "year(datum.date) == 2022" }
      ],
      "mark": {
        "type": "text",
        "align": "left",
        "dx": 6,
        "dy": -6,
        "fontSize": 11,
        "color": "black"
      },
      "encoding": {
        "y": {
          "field": "value",
          "type": "quantitative"
        },
        "x": { "value": 0 },
        "text": { "value": "2022 level" }
      }
    }
  ]
}
